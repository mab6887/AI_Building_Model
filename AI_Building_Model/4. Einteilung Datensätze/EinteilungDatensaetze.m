%Einteilung Datensätze Normalisierte Daten nehmen
D = readtimetable("cleanedData.txt"); %[output:4f824f2a]


%Ermittlung nicht verwertbarer Zeitabschnitte:
%plot(D.t, D.Q_sol)
%plot(D.t,D.EG_Utilities_degC)
%plot(D.t,D.T_Amb_degC)


% -> Entfernung von 01.11 10:00-09.11 17:30 & 17.11 10:00 - 27.11 16:00
startTime = datetime('01-Nov-2023 10:00:00');
endTime = datetime('09-Nov-2023 17:30:00');
rowsToDelete = D.timestamps >= startTime & D.timestamps <= endTime;
D(rowsToDelete, :) = [];

startTime = datetime('17-Nov-2023 10:00:00');
endTime = datetime('27-Nov-2023 16:00:00');
rowsToDelete = D.timestamps >= startTime & D.timestamps <= endTime;
D(rowsToDelete, :) = [];

%Einteilung des Datensatzes periodisch in 2 Wochen Training, 1 Woche
%Validierung, 1 Woche Test
%Dafinition: Woche startet wie Datensatz -> hier 01.09.2023 00.15 und endet
%7 Tage später um 00:00
% Sampling in 15min Takt -> in diesem Beispiel 672 Zeilen pro Woche

%Training

sIv1 = datetime('01-Sep-2023 00:15:00');
eIv1 = datetime('15-Sep-2023 00:00:00');
sIv2 = datetime('29-Sep-2023 00:15:00');
eIv2 = datetime('13-Oct-2023 00:00:00');
sIv3 = datetime('27-Oct-2023 00:15:00');
eIv3 = datetime('01-Dec-2023 00:00:00');
sIv4 = datetime('15-Dec-2023 00:15:00');
eIv4 = datetime('29-Dec-2023 00:00:00');
sIv5 = datetime('12-Jan-2024 00:15:00');
eIv5 = datetime('26-Jan-2024 00:00:00');
sIv6 = datetime('09-Feb-2024 00:15:00');
eIv6 = datetime('23-Feb-2024 00:00:00');
sIv7 = datetime('08-Mar-2024 00:15:00');
eIv7 = datetime('22-Mar-2024 00:00:00');
sIv8 = datetime('05-Apr-2024 00:15:00');
eIv8 = datetime('19-Apr-2024 00:00:00');

Training =     [D(D.timestamps >= sIv1 & D.timestamps <= eIv1,:)  %[output:group:41b05504] %[output:2e2db038]
                D(D.timestamps >= sIv2 & D.timestamps <= eIv2,:) %[output:2e2db038]
                D(D.timestamps >= sIv3 & D.timestamps <= eIv3,:) %[output:2e2db038]
                D(D.timestamps >= sIv4 & D.timestamps <= eIv4,:) %[output:2e2db038]
                D(D.timestamps >= sIv5 & D.timestamps <= eIv5,:) %[output:2e2db038]
                D(D.timestamps >= sIv6 & D.timestamps <= eIv6,:) %[output:2e2db038]
                D(D.timestamps >= sIv7 & D.timestamps <= eIv7,:) %[output:2e2db038]
                D(D.timestamps >= sIv8 & D.timestamps <= eIv8,:)] %[output:group:41b05504] %[output:2e2db038]

%Validierung

sIv1 = datetime('15-Sep-2023 00:15:00');
eIv1 = datetime('22-Sep-2023 00:00:00');
sIv2 = datetime('13-Oct-2023 00:15:00');
eIv2 = datetime('20-Oct-2023 00:00:00');
sIv3 = datetime('01-Dec-2023 00:15:00');
eIv3 = datetime('08-Dec-2023 00:00:00');
sIv4 = datetime('29-Dec-2023 00:15:00');
eIv4 = datetime('05-Jan-2024 00:00:00');
sIv5 = datetime('26-Jan-2024 00:15:00');
eIv5 = datetime('01-Feb-2024 00:00:00');
sIv6 = datetime('23-Feb-2024 00:15:00');
eIv6 = datetime('01-Mar-2024 00:00:00');
sIv7 = datetime('22-Mar-2024 00:15:00');
eIv7 = datetime('29-Mar-2024 00:00:00');
sIv8 = datetime('19-Apr-2024 00:15:00');
eIv8 = datetime('26-Apr-2024 00:00:00');

Validierung =  [D(D.timestamps >= sIv1 & D.timestamps <= eIv1,:)  %[output:group:12744ab0] %[output:2f41a829]
                D(D.timestamps >= sIv2 & D.timestamps <= eIv2,:) %[output:2f41a829]
                D(D.timestamps >= sIv3 & D.timestamps <= eIv3,:) %[output:2f41a829]
                D(D.timestamps >= sIv4 & D.timestamps <= eIv4,:) %[output:2f41a829]
                D(D.timestamps >= sIv5 & D.timestamps <= eIv5,:) %[output:2f41a829]
                D(D.timestamps >= sIv6 & D.timestamps <= eIv6,:) %[output:2f41a829]
                D(D.timestamps >= sIv7 & D.timestamps <= eIv7,:) %[output:2f41a829]
                D(D.timestamps >= sIv8 & D.timestamps <= eIv8,:)] %[output:group:12744ab0] %[output:2f41a829]

%Test

sIv1 = datetime('22-Sep-2023 00:15:00');
eIv1 = datetime('29-Sep-2023 00:00:00');
sIv2 = datetime('20-Oct-2023 00:15:00');
eIv2 = datetime('27-Oct-2023 00:00:00');
sIv3 = datetime('08-Dec-2023 00:15:00');
eIv3 = datetime('15-Dec-2023 00:00:00');
sIv4 = datetime('05-Jan-2024 00:15:00');
eIv4 = datetime('12-Jan-2024 00:00:00');
sIv5 = datetime('02-Feb-2024 00:15:00');
eIv5 = datetime('09-Feb-2024 00:00:00');
sIv6 = datetime('01-Mar-2024 00:15:00');
eIv6 = datetime('08-Mar-2024 00:00:00');
sIv7 = datetime('29-Mar-2024 00:15:00');
eIv7 = datetime('05-Apr-2024 00:00:00');
sIv8 = datetime('26-Apr-2024 00:15:00');
eIv8 = datetime('29-Apr-2024 23:45:00');

Test =         [D(D.timestamps >= sIv1 & D.timestamps <= eIv1,:)  %[output:group:58628903] %[output:7cf4858c]
                D(D.timestamps >= sIv2 & D.timestamps <= eIv2,:) %[output:7cf4858c]
                D(D.timestamps >= sIv3 & D.timestamps <= eIv3,:) %[output:7cf4858c]
                D(D.timestamps >= sIv4 & D.timestamps <= eIv4,:) %[output:7cf4858c]
                D(D.timestamps >= sIv5 & D.timestamps <= eIv5,:) %[output:7cf4858c]
                D(D.timestamps >= sIv6 & D.timestamps <= eIv6,:) %[output:7cf4858c]
                D(D.timestamps >= sIv7 & D.timestamps <= eIv7,:) %[output:7cf4858c]
                D(D.timestamps >= sIv8 & D.timestamps <= eIv8,:)] %[output:group:58628903] %[output:7cf4858c]

% Einteilung im Modell
% [trainInd,valInd,testInd] = divideind(24,Training,Validierung,Test)



%[appendix]
%---
%[metadata:view]
%   data: {"layout":"onright","rightPanelPercent":40}
%---
%[output:4f824f2a]
%   data: {"dataType":"tabular","outputData":{"columnNames":["timestamps","T_Amb_degC","Q_heat","Q_sol","Q_int","EG_LivingKitchen_degC","EG_HallwayEntrance_degC","EG_Utilities_degC","EG_Dressing_degC","EG_Sleeping_degC","EG_Bath_degC","EG_GuestBath_degC","EG_Server_degC","OG_Office_degC","OG_Sleeping_degC","OG_Bath_degC"],"columns":16,"dataTypes":["datetime","double","double","double","double","double","double","double","double","double","double","double","double","double","double","double"],"header":"23231×15 timetable","name":"D","rows":23231,"type":"timetable","value":[["01-Sep-2023 00:15:00","15.2000","0","0","100","21.2200","23.8600","23.2400","22.4000","22.9400","22.5000","23.8400","28.1800","21.8600","21.4400","23.3200"],["01-Sep-2023 00:30:00","15.0667","0","0","129.5850","21.1409","23.8600","23.2000","22.4333","23.0067","22.4600","23.8467","28.1800","21.8800","21.4267","23.3067"],["01-Sep-2023 00:45:00","14.7000","0","0","249.9800","21.0804","23.8798","23.2133","22.4333","23.0200","22.4467","23.8667","26.8600","21.8600","21.3867","23.3000"],["01-Sep-2023 01:00:00","14.5000","0","0","437.8537","20.9405","23.8403","23.1667","22.4200","23","22.4400","23.8400","26.2000","21.8533","21.3733","23.2933"],["01-Sep-2023 01:15:00","14.1333","0","0","452.0200","20.9203","23.8597","23.1600","22.4267","23.0133","22.4467","23.8533","26.2000","21.8467","21.3267","23.2800"],["01-Sep-2023 01:30:00","13.8667","0","0","247.6013","20.8405","23.8603","23.1133","22.4267","23.0600","22.4333","23.8400","26.2000","21.8533","21.3067","23.2733"],["01-Sep-2023 01:45:00","13.7667","0","0","206.5033","20.8600","23.8795","23.1067","22.4467","23.0667","22.4333","23.8333","26.2000","21.8400","21.2800","23.2733"],["01-Sep-2023 02:00:00","13.8000","0","0","193.5414","20.8200","23.8403","23.0867","22.4333","23.0733","22.4067","23.8267","26.2000","21.8333","21.2467","23.2600"],["01-Sep-2023 02:15:00","13.9667","0","0","194.0634","20.7803","23.8595","23.0600","22.4200","23.0867","22.4133","23.8067","26.2000","21.8267","21.2400","23.2600"],["01-Sep-2023 02:30:00","14.0333","0","0","191.8704","20.7995","23.8597","23.0600","22.4400","23.0867","22.4267","23.8200","26.2000","21.8000","21.2200","23.2467"],["01-Sep-2023 02:45:00","14.2000","0","0","198.3935","20.8200","23.8797","23.0200","22.4267","23.0533","22.4133","23.8000","26.2000","21.8000","21.2267","23.2333"],["01-Sep-2023 03:00:00","14.7333","0","0","200.1096","20.8400","23.9000","23.0267","22.4200","23.0467","22.4000","23.8067","26.2000","21.7867","21.2133","23.2333"],["01-Sep-2023 03:15:00","14.3333","0","0","197.7338","20.8795","23.9000","23.0067","22.4200","23.0467","22.4000","23.7933","26.2000","21.8000","21.2200","23.2267"],["01-Sep-2023 03:30:00","14.2667","0","0","196.6035","20.8404","23.9400","23.0067","22.4133","23.0533","22.4067","23.8067","26.2000","21.8000","21.2267","23.2200"]]}}
%---
%[output:2e2db038]
%   data: {"dataType":"tabular","outputData":{"columnNames":["timestamps","T_Amb_degC","Q_heat","Q_sol","Q_int","EG_LivingKitchen_degC","EG_HallwayEntrance_degC","EG_Utilities_degC","EG_Dressing_degC","EG_Sleeping_degC","EG_Bath_degC","EG_GuestBath_degC","EG_Server_degC","OG_Office_degC","OG_Sleeping_degC","OG_Bath_degC"],"columns":16,"dataTypes":["datetime","double","double","double","double","double","double","double","double","double","double","double","double","double","double","double"],"header":"10988×15 timetable","name":"Training","rows":10988,"type":"timetable","value":[["01-Sep-2023 00:15:00","15.2000","0","0","100","21.2200","23.8600","23.2400","22.4000","22.9400","22.5000","23.8400","28.1800","21.8600","21.4400","23.3200"],["01-Sep-2023 00:30:00","15.0667","0","0","129.5850","21.1409","23.8600","23.2000","22.4333","23.0067","22.4600","23.8467","28.1800","21.8800","21.4267","23.3067"],["01-Sep-2023 00:45:00","14.7000","0","0","249.9800","21.0804","23.8798","23.2133","22.4333","23.0200","22.4467","23.8667","26.8600","21.8600","21.3867","23.3000"],["01-Sep-2023 01:00:00","14.5000","0","0","437.8537","20.9405","23.8403","23.1667","22.4200","23","22.4400","23.8400","26.2000","21.8533","21.3733","23.2933"],["01-Sep-2023 01:15:00","14.1333","0","0","452.0200","20.9203","23.8597","23.1600","22.4267","23.0133","22.4467","23.8533","26.2000","21.8467","21.3267","23.2800"],["01-Sep-2023 01:30:00","13.8667","0","0","247.6013","20.8405","23.8603","23.1133","22.4267","23.0600","22.4333","23.8400","26.2000","21.8533","21.3067","23.2733"],["01-Sep-2023 01:45:00","13.7667","0","0","206.5033","20.8600","23.8795","23.1067","22.4467","23.0667","22.4333","23.8333","26.2000","21.8400","21.2800","23.2733"],["01-Sep-2023 02:00:00","13.8000","0","0","193.5414","20.8200","23.8403","23.0867","22.4333","23.0733","22.4067","23.8267","26.2000","21.8333","21.2467","23.2600"],["01-Sep-2023 02:15:00","13.9667","0","0","194.0634","20.7803","23.8595","23.0600","22.4200","23.0867","22.4133","23.8067","26.2000","21.8267","21.2400","23.2600"],["01-Sep-2023 02:30:00","14.0333","0","0","191.8704","20.7995","23.8597","23.0600","22.4400","23.0867","22.4267","23.8200","26.2000","21.8000","21.2200","23.2467"],["01-Sep-2023 02:45:00","14.2000","0","0","198.3935","20.8200","23.8797","23.0200","22.4267","23.0533","22.4133","23.8000","26.2000","21.8000","21.2267","23.2333"],["01-Sep-2023 03:00:00","14.7333","0","0","200.1096","20.8400","23.9000","23.0267","22.4200","23.0467","22.4000","23.8067","26.2000","21.7867","21.2133","23.2333"],["01-Sep-2023 03:15:00","14.3333","0","0","197.7338","20.8795","23.9000","23.0067","22.4200","23.0467","22.4000","23.7933","26.2000","21.8000","21.2200","23.2267"],["01-Sep-2023 03:30:00","14.2667","0","0","196.6035","20.8404","23.9400","23.0067","22.4133","23.0533","22.4067","23.8067","26.2000","21.8000","21.2267","23.2200"]]}}
%---
%[output:2f41a829]
%   data: {"dataType":"tabular","outputData":{"columnNames":["timestamps","T_Amb_degC","Q_heat","Q_sol","Q_int","EG_LivingKitchen_degC","EG_HallwayEntrance_degC","EG_Utilities_degC","EG_Dressing_degC","EG_Sleeping_degC","EG_Bath_degC","EG_GuestBath_degC","EG_Server_degC","OG_Office_degC","OG_Sleeping_degC","OG_Bath_degC"],"columns":16,"dataTypes":["datetime","double","double","double","double","double","double","double","double","double","double","double","double","double","double","double"],"header":"5280×15 timetable","name":"Validierung","rows":5280,"type":"timetable","value":[["15-Sep-2023 00:15:00","11.4000","0","0","203.6692","21.2063","23.9463","23.1200","22.5600","22.7800","22.8800","24.3600","29.2000","22.0900","21.5400","23.5200"],["15-Sep-2023 00:30:00","11.2667","0","0","263.1486","21.1803","23.9403","23.0867","22.5667","22.8200","22.8867","24.3867","29.2000","22.0933","21.5133","23.5067"],["15-Sep-2023 00:45:00","11","0","0","181.4854","21.1600","23.9797","23.0800","22.5667","22.8733","22.8733","24.4000","29.2000","22.1067","21.5200","23.5267"],["15-Sep-2023 01:00:00","10.9667","0","0","181.9733","21.1800","23.9603","23.0533","22.5400","22.9333","22.8800","24.3800","29.2000","22.1267","21.5400","23.5200"],["15-Sep-2023 01:15:00","10.6667","0","0","187.0856","21.1403","23.9403","23.0400","22.5600","22.9533","22.8733","24.3867","29.2000","22.1067","21.5333","23.5067"],["15-Sep-2023 01:30:00","10.5667","0","0","189.6323","21.1204","23.9602","23.0067","22.5333","22.9933","22.8600","24.3933","29.2000","22.1067","21.5400","23.5200"],["15-Sep-2023 01:45:00","10.6667","0","0","186.4344","21.1204","23.9602","23.0200","22.5533","22.9867","22.8467","24.3733","29.2000","22.0933","21.5467","23.5000"],["15-Sep-2023 02:00:00","10.3667","0","0","180.0351","21.1400","24.0195","23.0200","22.5467","22.9733","22.8467","24.3733","29.2000","22.1267","21.5400","23.4400"],["15-Sep-2023 02:15:00","10.5000","0","0","178.9933","21.1402","23.9998","23.0200","22.5467","22.9800","22.8533","24.3600","29.2000","22.1000","21.5600","23.3933"],["15-Sep-2023 02:30:00","10.3667","0","0","175.4205","21.1205","23.9603","22.9933","22.5467","22.9867","22.8533","24.3533","29.2000","22.1067","21.5600","23.3800"],["15-Sep-2023 02:45:00","10.1333","0","0","176","21.1200","23.9995","22.9667","22.5400","22.9933","22.8133","24.3533","29.2000","22.0867","21.5800","23.4000"],["15-Sep-2023 03:00:00","9.9667","0","0","179.0704","21.1203","24","22.9467","22.5333","22.9733","22.8200","24.3467","29.2000","22.1000","21.5867","23.4333"],["15-Sep-2023 03:15:00","9.9667","0","0","183.9867","21.0806","23.9800","22.9533","22.5200","22.9333","22.8133","24.3533","29.2000","22.0933","21.5933","23.4067"],["15-Sep-2023 03:30:00","10.2000","0","0","192.3365","21.1000","23.9800","22.9267","22.5333","22.9467","22.8267","24.3333","29.2000","22.0867","21.5800","23.4467"]]}}
%---
%[output:7cf4858c]
%   data: {"dataType":"tabular","outputData":{"columnNames":["timestamps","T_Amb_degC","Q_heat","Q_sol","Q_int","EG_LivingKitchen_degC","EG_HallwayEntrance_degC","EG_Utilities_degC","EG_Dressing_degC","EG_Sleeping_degC","EG_Bath_degC","EG_GuestBath_degC","EG_Server_degC","OG_Office_degC","OG_Sleeping_degC","OG_Bath_degC"],"columns":16,"dataTypes":["datetime","double","double","double","double","double","double","double","double","double","double","double","double","double","double","double"],"header":"5083×15 timetable","name":"Test","rows":5083,"type":"timetable","value":[["22-Sep-2023 00:15:00","15.5500","0","0","186.5891","22.6459","25.0059","24.2000","23.2000","23.7800","22.7500","24.5400","29.4600","23.3100","23.5600","25.0400"],["22-Sep-2023 00:30:00","15.5000","0","0","246.1001","22.6004","25.0396","24.2067","23.2200","23.7733","22.7400","24.5400","29.4600","23.3133","23.5333","25.0267"],["22-Sep-2023 00:45:00","15.3000","0","0","178.8667","22.5803","24.9997","24.2067","23.2067","23.7933","22.7133","24.5333","29.4600","23.3133","23.5333","25.0067"],["22-Sep-2023 01:00:00","15.4333","0","0","180.5067","22.5800","24.9803","24.1867","23.2067","23.8000","22.7267","24.5400","29.4600","23.3133","23.5400","25.0067"],["22-Sep-2023 01:15:00","15.5000","0","0","181.5067","22.5608","25","24.1733","23.2000","23.8000","22.7467","24.5467","29.4600","23.3267","23.5133","25.0067"],["22-Sep-2023 01:30:00","15.6000","0","0","177.5146","22.5800","24.9800","24.1467","23.2067","23.7933","22.7133","24.5333","29.4600","23.3600","23.5133","25.0067"],["22-Sep-2023 01:45:00","15.4333","0","0","173.5279","22.5797","24.9800","24.1400","23.2000","23.8200","22.7133","24.5133","29.4600","23.3400","23.5000","24.9867"],["22-Sep-2023 02:00:00","15.3000","0","0","174.9321","22.5600","24.9800","24.1200","23.2000","23.8267","22.6933","24.5133","29.4600","23.3200","23.4933","24.9800"],["22-Sep-2023 02:15:00","15.1333","0","0","176.4987","22.5208","24.9797","24.1200","23.2133","23.8600","22.7000","24.5267","29.4600","23.3600","23.4867","24.9800"],["22-Sep-2023 02:30:00","15.0333","0","0","178.5000","22.5403","24.9997","24.1200","23.2000","23.8333","22.6800","24.5267","29.4600","23.3400","23.4867","24.9667"],["22-Sep-2023 02:45:00","15.0333","0","0","182.4533","22.5203","24.9797","24.1133","23.2200","23.8400","22.6933","24.5200","29.4600","23.3333","23.4800","24.9600"],["22-Sep-2023 03:00:00","15.1333","0","0","187.5000","22.5195","24.9797","24.1200","23.1800","23.8467","22.6867","24.5133","29.4600","23.3267","23.4667","24.9533"],["22-Sep-2023 03:15:00","15.2000","0","0","188","22.5397","24.9400","24.1267","23.2000","23.8533","22.6800","24.5133","29.4600","23.3200","23.4533","24.9400"],["22-Sep-2023 03:30:00","15.0667","0","0","183.1373","22.5395","24.9600","24.1333","23.2067","23.8600","22.6800","24.5067","29.4600","23.3067","23.4733","24.9467"]]}}
%---
